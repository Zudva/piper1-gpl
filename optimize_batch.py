#!/usr/bin/env python3
"""–†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ batch_size –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU"""

print("üìä –ê–ù–ê–õ–ò–ó –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –ü–ê–ú–Ø–¢–ò GPU")
print("=" * 70)

print("\nüíæ L40S GPU: 46068 MB VRAM")
print()

print("üìà –¢–ï–ö–£–©–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø:")
print("  ‚Ä¢ batch_size = 48")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ~26-30 GB (~58-65%)")
print("  ‚Ä¢ –°–≤–æ–±–æ–¥–Ω–æ: ~16-20 GB (–Ω–µ–¥–æ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è!)")

print("\n‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–í–ï–õ–ò–ß–ï–ù–ò–Æ:")
print()

print("–í–∞—Ä–∏–∞–Ω—Ç 1 (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π +25%):")
print("  ‚Ä¢ batch_size = 56")
print("  ‚Ä¢ –û–∂–∏–¥–∞–µ–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ~30-34 GB (~70-75%)")
print("  ‚Ä¢ –ó–∞–ø–∞—Å: ~12-16 GB")
print("  ‚Ä¢ Total effective batch: 56 √ó 2 = 112")
print()

print("–í–∞—Ä–∏–∞–Ω—Ç 2 (–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π +33%):")
print("  ‚Ä¢ batch_size = 64")
print("  ‚Ä¢ –û–∂–∏–¥–∞–µ–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ~34-38 GB (~75-82%)")
print("  ‚Ä¢ –ó–∞–ø–∞—Å: ~8-12 GB")
print("  ‚Ä¢ Total effective batch: 64 √ó 2 = 128")
print()

print("–í–∞—Ä–∏–∞–Ω—Ç 3 (–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π +50%):")
print("  ‚Ä¢ batch_size = 72")
print("  ‚Ä¢ –û–∂–∏–¥–∞–µ–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ~38-42 GB (~85-92%)")
print("  ‚Ä¢ –ó–∞–ø–∞—Å: ~4-8 GB (—Ä–∏—Å–∫ OOM –ø—Ä–∏ –ø–∏–∫–∞—Ö)")
print("  ‚Ä¢ Total effective batch: 72 √ó 2 = 144")

print("\nüéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: batch_size = 64")
print()
print("  –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:")
print("    ‚úÖ –õ—É—á—à–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU (~80%)")
print("    ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞–ø–∞—Å –ø–∞–º—è—Ç–∏")
print("    ‚úÖ Total batch 128 - —Ö–æ—Ä–æ—à –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤")
print("    ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å: ~1.0-1.1 it/s (–Ω–µ–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ)")
print()
print("  –í—Ä–µ–º—è –Ω–∞ —ç–ø–æ—Ö—É:")
print("    –¢–µ–∫—É—â–µ–µ: ~1.5 –º–∏–Ω—É—Ç—ã")
print("    –° batch=64: ~1.2-1.3 –º–∏–Ω—É—Ç—ã (–Ω–∞ 15-20% –±—ã—Å—Ç—Ä–µ–µ)")

print("\n‚ö° –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ô –ü–†–ò–†–û–°–¢:")
print("  ‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è: +15-20%")
print("  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤: –ª—É—á—à–µ (–±–æ–ª—å—à–∏–π batch)")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –±–µ–∑ —Ä–∏—Å–∫–∞")

print("\n" + "=" * 70)
print("\n–û–±–Ω–æ–≤–∏—Ç—å train_safe.sh —Å batch_size=64?")
