#!/usr/bin/env python3
"""–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ batch_size –¥–ª—è DDP"""

print("‚ö†Ô∏è  –í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ batch_size –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏\n")
print("=" * 70)

print("\nüìä –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ train_from_749.sh:")
print("  ‚Ä¢ batch_size = 80")
print("  ‚Ä¢ devices = 2 (GPU)")
print("  ‚Ä¢ strategy = ddp")

print("\n‚ùå –ü–†–û–ë–õ–ï–ú–ê - DDP —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:")
print("  ‚Ä¢ –í PyTorch Lightning –ø—Ä–∏ DDP, batch_size –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ù–ê –ö–ê–ñ–î–´–ô GPU")
print("  ‚Ä¢ –¢–µ–∫—É—â–∏–π total batch size = 80 √ó 2 = 160")
print("  ‚Ä¢ –ö–∞–∂–¥—ã–π GPU –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 80 —Å—ç–º–ø–ª–æ–≤ (–Ω–µ 40!)")

print("\nüíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:")
print("  ‚Ä¢ GPU 0: 45201 MB / 46080 MB (98% –∑–∞–ø–æ–ª–Ω–µ–Ω–æ!) ‚ö†Ô∏è")
print("  ‚Ä¢ GPU 1: 42235 MB / 46080 MB (92% –∑–∞–ø–æ–ª–Ω–µ–Ω–æ!)")
print("  ‚Ä¢ –†–∏—Å–∫ OOM (Out Of Memory) –ø—Ä–∏ –ø–∏–∫–∞—Ö!")

print("\n‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:")
print()
print("–í–∞—Ä–∏–∞–Ω—Ç 1 (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π):")
print("  ‚Ä¢ batch_size = 40  ‚Üí total = 80  (–ø–æ 40 –Ω–∞ GPU)")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ~22-25GB –Ω–∞ GPU")
print("  ‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø–∞—Å –ø–∞–º—è—Ç–∏")
print()
print("–í–∞—Ä–∏–∞–Ω—Ç 2 (–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π):")
print("  ‚Ä¢ batch_size = 48  ‚Üí total = 96  (–ø–æ 48 –Ω–∞ GPU)")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ~26-30GB –Ω–∞ GPU")
print("  ‚Ä¢ –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
print()
print("–í–∞—Ä–∏–∞–Ω—Ç 3 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π):")
print("  ‚Ä¢ batch_size = 52  ‚Üí total = 104 (–ø–æ 52 –Ω–∞ GPU)")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ~30-35GB –Ω–∞ GPU")
print("  ‚Ä¢ –ë—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–µ–Ω—å—à–µ –∑–∞–ø–∞—Å–∞")

print("\nüéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å batch_size = 48")
print("  ‚Ä¢ –≠—Ç–æ –¥–∞—Å—Ç total effective batch = 96")
print("  ‚Ä¢ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è 2x L40S (46GB VRAM)")
print("  ‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∑–∞–ø–∞—Å –¥–ª—è –ø–∏–∫–æ–≤ –ø–∞–º—è—Ç–∏")

print("\n" + "=" * 70)
print("\n–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é? (–∏–∑–º–µ–Ω–∏—Ç—å batch_size –Ω–∞ 48)")
