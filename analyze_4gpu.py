#!/usr/bin/env python3
"""–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ 2 GPU (2x ‚Üí 4x L40S)"""

print("üìä –ê–ù–ê–õ–ò–ó SCALING: 2x L40S ‚Üí 4x L40S")
print("=" * 70)

print("\nüî¢ –¢–ï–ö–£–©–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (2x L40S):")
print("  ‚Ä¢ batch_size = 48 per GPU ‚Üí total effective = 96")
print("  ‚Ä¢ num_workers = 4")
print("  ‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: ~0.25 it/s (–Ω–∞ —Å—Ç–∞—Ä—Ç–µ)")
print("  ‚Ä¢ –í—Ä–µ–º—è –Ω–∞ —ç–ø–æ—Ö—É: ~5-6 –º–∏–Ω—É—Ç (79 –∏—Ç–µ—Ä–∞—Ü–∏–π)")
print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ~26-30GB per GPU")

print("\n‚ö° –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ò–ô –ü–†–ò–†–û–°–¢ (4x L40S):")
print("  ‚Ä¢ –ò–¥–µ–∞–ª—å–Ω—ã–π scaling: 2.0x (—É–¥–≤–æ–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏)")
print("  ‚Ä¢ –†–µ–∞–ª—å–Ω—ã–π scaling: 1.4-1.8x (70-90% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)")
print()
print("  –ü–æ—á–µ–º—É –Ω–µ 2x?")
print("  ‚ùå Overhead DDP –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ (–±–æ–ª—å—à–µ GPU = –±–æ–ª—å—à–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)")
print("  ‚ùå I/O —É–∑–∫–æ–µ –º–µ—Å—Ç–æ (–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–∏—Å–∫–∞)")
print("  ‚ùå CPU bottleneck (–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥, augmentation)")
print("  ‚ùå NCCL collective operations overhead")

print("\nüìà –û–ñ–ò–î–ê–ï–ú–ê–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ (4x L40S):")
print()
print("  –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ (70% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å):")
print("    ‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: ~0.35 it/s (–±—ã–ª–æ 0.25)")
print("    ‚Ä¢ –í—Ä–µ–º—è –Ω–∞ —ç–ø–æ—Ö—É: ~3.5-4 –º–∏–Ω—É—Ç—ã (–±—ã–ª–æ 5-6)")
print("    ‚Ä¢ –ü—Ä–∏—Ä–æ—Å—Ç: 1.4x")
print()
print("  –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ (85% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å):")
print("    ‚Ä¢ –°–∫–æ—Ä–æ—Å—Ç—å: ~0.42 it/s")
print("    ‚Ä¢ –í—Ä–µ–º—è –Ω–∞ —ç–ø–æ—Ö—É: ~3 –º–∏–Ω—É—Ç—ã")
print("    ‚Ä¢ –ü—Ä–∏—Ä–æ—Å—Ç: 1.7x")

print("\n‚öôÔ∏è  –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –î–õ–Ø 4x L40S:")
print()
print("  –í–∞—Ä–∏–∞–Ω—Ç 1 (–±–µ–∑–æ–ø–∞—Å–Ω—ã–π):")
print("    --data.batch_size 48")
print("    --data.num_workers 8")
print("    --trainer.devices 4")
print("    ‚Üí total batch = 192")
print()
print("  –í–∞—Ä–∏–∞–Ω—Ç 2 (–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π):")
print("    --data.batch_size 56")
print("    --data.num_workers 8")
print("    --trainer.devices 4")
print("    ‚Üí total batch = 224 (–ª—É—á—à–µ –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤)")
print()
print("  –í–∞—Ä–∏–∞–Ω—Ç 3 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π):")
print("    --data.batch_size 60")
print("    --data.num_workers 10")
print("    --trainer.devices 4")
print("    ‚Üí total batch = 240")

print("\nüí∞ –°–¢–û–ò–ú–û–°–¢–¨ vs –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨:")
print()
print("  –°—Ç–æ–∏–º–æ—Å—Ç—å GPU:")
print("    ‚Ä¢ 2x L40S: ~$1.20-1.60/—á–∞—Å")
print("    ‚Ä¢ 4x L40S: ~$2.40-3.20/—á–∞—Å (2x –¥–æ—Ä–æ–∂–µ)")
print()
print("  –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞—Ç—Ä–∞—Ç:")
print("    ‚Ä¢ –ü—Ä–∏—Ä–æ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏: 1.4-1.7x")
print("    ‚Ä¢ –ü—Ä–∏—Ä–æ—Å—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏: 2.0x")
print("    ‚Ä¢ Cost efficiency: 70-85% (–Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)")
print()
print("  ‚ö†Ô∏è  –í–´–í–û–î: –£–¥–≤–æ–µ–Ω–∏–µ GPU –¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ 40-70% –ø—Ä–∏—Ä–æ—Å—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏")
print("              –ø—Ä–∏ —É–¥–≤–æ–µ–Ω–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è")
print("              cost/performance –æ—Å—Ç–∞—Ç—å—Å—è –Ω–∞ 2x GPU.")

print("\n‚úÖ –ö–û–ì–î–ê –°–¢–û–ò–¢ –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ 4x GPU:")
print("  ‚Ä¢ –û—á–µ–Ω—å —Å—Ä–æ—á–Ω—ã–π –¥–µ–¥–ª–∞–π–Ω (–≤—Ä–µ–º—è –≤–∞–∂–Ω–µ–µ –¥–µ–Ω–µ–≥)")
print("  ‚Ä¢ –ë–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç (>50k samples)")
print("  ‚Ä¢ –ù—É–∂–µ–Ω –±–æ–ª—å—à–æ–π batch size –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏")
print("  ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ GPU —Ä–µ—Å—É—Ä—Å—ã (RunPod credits)")

print("\n‚ùå –ö–û–ì–î–ê –ù–ï –°–¢–û–ò–¢:")
print("  ‚Ä¢ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç")
print("  ‚Ä¢ –î–∞—Ç–∞—Å–µ—Ç <10k samples")
print("  ‚Ä¢ –ù–µ—Ç —Å–ø–µ—à–∫–∏ (–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ª—å—à–µ)")
print("  ‚Ä¢ I/O —É–∂–µ —É–∑–∫–æ–µ –º–µ—Å—Ç–æ (SSD –º–µ–¥–ª–µ–Ω–Ω—ã–π)")

print("\nüéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –î–õ–Ø –í–ê–®–ï–ì–û –°–õ–£–ß–ê–Ø:")
print("  ‚Ä¢ –î–∞—Ç–∞—Å–µ—Ç: 8,397 samples (—Å—Ä–µ–¥–Ω–∏–π)")
print("  ‚Ä¢ –¢–µ–∫—É—â–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: –ø—Ä–∏–µ–º–ª–µ–º–∞—è (~35-40 min –Ω–∞ —ç–ø–æ—Ö—É)")
print("  ‚Ä¢ –ß–µ–∫–ø–æ–∏–Ω—Ç: epoch 749 (—É–∂–µ –º–Ω–æ–≥–æ –Ω–∞—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª–∏)")
print()
print("  ‚úÖ –û–°–¢–ê–í–ê–ô–¢–ï–°–¨ –ù–ê 2x L40S - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –ø–æ cost/performance")
print("  üìä –ò–ª–∏ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ 4x GPU –Ω–∞ 1-2 —ç–ø–æ—Ö–∏ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è")

print("\n" + "=" * 70)
